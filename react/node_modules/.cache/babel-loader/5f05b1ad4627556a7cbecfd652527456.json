{"ast":null,"code":"import _regeneratorRuntime from\"/Users/byungmoonkim/dev/react-blog/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/byungmoonkim/dev/react-blog/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/byungmoonkim/dev/react-blog/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Context}from\"../../context/Context\";import{useContext,useState}from\"react\";import Sidebar from\"../../components/sidebar/Sidebar\";import axios from\"axios\";import\"./setting.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Setting(){var _useContext=useContext(Context),user=_useContext.user,dispatch=_useContext.dispatch;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),email=_useState6[0],setEmail=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),success=_useState10[0],setSuccess=_useState10[1];var PF=\"http://localhost:5000/images/\";var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var updatedUser,data,filename,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();dispatch({type:\"UPDATE_START\"});updatedUser={userId:user._id,username:username,email:email,password:password};if(!file){_context.next=16;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);updatedUser.profilePic=filename;_context.prev=9;_context.next=12;return axios.post(\"/upload\",data);case 12:_context.next=16;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](9);case 16:_context.prev=16;_context.next=19;return axios.put(\"/users/\"+user._id,updatedUser);case 19:res=_context.sent;setSuccess(true);dispatch({type:\"UPDATE_SUCCESS\",payload:res.data});_context.next=27;break;case 24:_context.prev=24;_context.t1=_context[\"catch\"](16);dispatch({type:\"UPDATE_FAILURE\"});case 27:case\"end\":return _context.stop();}}},_callee,null,[[9,14],[16,24]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"settings\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"settingsWrapper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"settingsTitle\",children:/*#__PURE__*/_jsx(\"span\",{className:\"settingsTitleUpdate\",children:\"Update Your Account\"})}),/*#__PURE__*/_jsxs(\"form\",{className:\"settingsForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"settingsPP\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\"}),/*#__PURE__*/_jsx(\"input\",{id:\"fileInput\",type:\"file\",style:{display:\"none\"},className:\"settingsPPInput\",onChange:function onChange(e){return setFile(e.target.files[0]);}})]}),/*#__PURE__*/_jsx(\"label\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:user.username,name:\"name\",onChange:function onChange(e){return setUsername(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:user.email,name:\"email\",onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"settingsSubmitButton\",type:\"submit\",children:\"Update\"}),success&&/*#__PURE__*/_jsx(\"span\",{style:{color:\"green\",textAlign:\"center\",marginTop:\"20px\"},children:\"Profile has been updated...\"})]})]}),/*#__PURE__*/_jsx(Sidebar,{})]});}","map":{"version":3,"sources":["/Users/byungmoonkim/dev/react-blog/react/src/pages/settings/Setting.js"],"names":["Context","useContext","useState","Sidebar","axios","Setting","user","dispatch","file","setFile","username","setUsername","email","setEmail","password","setPassword","success","setSuccess","PF","handleSubmit","e","preventDefault","type","updatedUser","userId","_id","data","FormData","filename","Date","now","name","append","profilePic","post","put","res","payload","display","target","files","value","color","textAlign","marginTop"],"mappings":"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","sourcesContent":["import {Context} from \"../../context/Context\";\nimport { useContext, useState } from \"react\";\nimport Sidebar from \"../../components/sidebar/Sidebar\";\nimport axios from \"axios\";\nimport \"./setting.css\"\n\nexport default function Setting() {\n    const {user, dispatch} = useContext(Context);\n    const [file, setFile] = useState(null);\n    const [username, setUsername] = useState(\"\");\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [success, setSuccess] = useState(false);\n    const PF = \"http://localhost:5000/images/\"\n\n    const handleSubmit = async (e) => {\n      e.preventDefault();\n      dispatch({type:\"UPDATE_START\"})\n      const updatedUser = {\n          userId: user._id,\n          username,\n          email,\n          password,\n      };\n      if(file){\n          const data =  new FormData();\n          const filename = Date.now() + file.name;\n          data.append(\"name\", filename);\n          data.append(\"file\", file);\n          updatedUser.profilePic = filename;\n          try{\n              await axios.post(\"/upload\", data);\n            } catch(err){}\n          }\n          try{\n            const res = await axios.put(\"/users/\"+user._id, updatedUser);\n            setSuccess(true);\n            dispatch({type:\"UPDATE_SUCCESS\", payload: res.data })\n      }catch(err){\n        dispatch({type:\"UPDATE_FAILURE\"})\n      }\n  }\n    return (\n        <div className=\"settings\">\n      <div className=\"settingsWrapper\">\n        <div className=\"settingsTitle\">\n          <span className=\"settingsTitleUpdate\">Update Your Account</span>\n          {/* <span className=\"settingsTitleDelete\">Delete Account</span> */}\n        </div>\n        <form className=\"settingsForm\" onSubmit={handleSubmit}>\n          {/* <label>Profile Picture</label> */}\n          <div className=\"settingsPP\">\n            {/* <img\n              src={file ? URL.createObjectURL(file) : PF + user.profilePic}\n              alt=\"\"\n            /> */}\n            <label htmlFor=\"fileInput\">\n              {/* <i className=\"settingsPPIcon far fa-user-circle\"></i>{\" \"} */}\n            </label>\n            <input\n              id=\"fileInput\"\n              type=\"file\"\n              style={{ display: \"none\" }}\n              className=\"settingsPPInput\"\n              onChange={(e) => setFile(e.target.files[0])}\n            />\n          </div>\n          <label>Username</label>\n          <input type=\"text\" placeholder={user.username} name=\"name\" onChange={(e) => setUsername(e.target.value)}/>\n          <label>Email</label>\n          <input type=\"email\" placeholder={user.email} name=\"email\" onChange={(e)=> setEmail(e.target.value)} />\n          <label>Password</label>\n          <input type=\"password\" name=\"password\" onChange={(e) => setPassword(e.target.value)} />\n          <button className=\"settingsSubmitButton\" type=\"submit\">\n            Update\n          </button>\n          {success && <span style={{color: \"green\", textAlign: \"center\", marginTop:\"20px\"}}>Profile has been updated...</span>}\n        </form>\n      </div>\n      <Sidebar />\n    </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}