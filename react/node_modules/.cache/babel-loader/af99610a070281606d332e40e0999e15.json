{"ast":null,"code":"import _regeneratorRuntime from\"/Users/byungmoonkim/dev/react-blog/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/byungmoonkim/dev/react-blog/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/byungmoonkim/dev/react-blog/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useLocation}from\"react-router\";import{useEffect,useState,useContext}from\"react\";import axios from\"axios\";import\"./singlepost.css\";import{Link}from\"react-router-dom\";import{Context}from\"../../context/Context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SinglePost(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var PF=\"http://localhost:5000/images/\";var _useContext=useContext(Context),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateMode=_useState8[0],setUpdateMode=_useState8[1];useEffect(function(){var getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/posts/\"+path);case 2:res=_context.sent;setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getPost(){return _ref.apply(this,arguments);};}();getPost();},[path]);var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/posts/\".concat(post._id),{data:{username:user.username}});case 3:window.location.replace(\"/\");_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.put(\"/posts/\".concat(post._id),{username:user.username,title:title,desc:desc});case 3://window.location.reload();\nsetUpdateMode(false);_context3.next=8;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"singlePost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{src:PF+post.photo,alt:\"\",lassName:\"singlePostImg\",className:\"slgImg\"}),updateMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,className:\"singlePostTitleInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singlePostTitle\",children:[title,post.username===(user===null||user===void 0?void 0:user.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-edit\",onClick:function onClick(){return setUpdateMode(true);}}),/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-trash-alt\",onClick:handleDelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlePostAuthor\",children:[\"Author:\",/*#__PURE__*/_jsx(Link,{to:\"/?user=\".concat(post.username),className:\"link\",children:/*#__PURE__*/_jsx(\"b\",{children:post.username})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlePostDate\",children:new Date(post.createdAt).toDateString()})]}),updateMode?/*#__PURE__*/_jsx(\"textarea\",{className:\"singlePostDescInput\",value:desc,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/_jsxs(\"p\",{className:\"singlePostDesc\",children:[\" \",desc,\" \"]}),updateMode&&/*#__PURE__*/_jsx(\"button\",{className:\"singlePostButton\",onClick:handleUpdate,children:\"Update\"})]})});}","map":{"version":3,"sources":["/Users/byungmoonkim/dev/react-blog/react/src/components/singlePost/SinglePost.js"],"names":["useLocation","useEffect","useState","useContext","axios","Link","Context","SinglePost","location","path","pathname","split","post","setPost","PF","user","title","setTitle","desc","setDesc","updateMode","setUpdateMode","getPost","get","res","data","handleDelete","delete","_id","username","window","replace","handleUpdate","put","photo","e","target","value","Date","createdAt","toDateString"],"mappings":"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","sourcesContent":["import { useLocation } from \"react-router\"\nimport { useEffect , useState, useContext } from \"react\";\nimport axios from \"axios\"\nimport \"./singlepost.css\"\nimport {Link} from \"react-router-dom\"\nimport { Context } from \"../../context/Context\";\n\nexport default function SinglePost() {\n    const location = useLocation();\n    const path = (location.pathname.split(\"/\")[2]);\n    const [post, setPost] = useState({});\n    const PF = \"http://localhost:5000/images/\"\n    const {user} = useContext(Context);\n    const [ title, setTitle] = useState(\"\");\n    const [desc, setDesc] = useState(\"\");\n    const [updateMode, setUpdateMode] = useState(false);\n\n    useEffect(() => {\n        const getPost = async () => {\n            const res = await axios.get(\"/posts/\" + path);\n            setPost(res.data);\n            setTitle(res.data.title);\n            setDesc(res.data.desc);\n        };\n        getPost();\n    }, [path]);\n\n\n    const handleDelete = async() => {\n        try{\n            await axios.delete(`/posts/${post._id}`, {\n               data: {username: user.username}\n            });\n            window.location.replace(\"/\");\n        } catch(err) {}\n    };\n\n    const handleUpdate = async() => {\n        try{\n            await axios.put(`/posts/${post._id}`, {\n                username: user.username, title, desc\n            });\n            //window.location.reload();\n            setUpdateMode(false);\n        }catch(err){}\n    }\n\n    return (\n        <div className=\"singlePost\">\n            <div className=\"singlePostWrapper\">\n            {post.photo && (\n                <img src={PF + post.photo} alt=\"\" lassName=\"singlePostImg\" className=\"slgImg\" />\n            )}{\n                updateMode ? <input type=\"text\" value={title} className=\"singlePostTitleInput\" autoFocus onChange={(e)=> setTitle(e.target.value)}/> : (\n                    <h1 className=\"singlePostTitle\">\n                        {title}\n                        {post.username === user?.username && (\n\n                            <div className=\"singlePostEdit\">\n                                <i className=\"singlePostIcon far fa-edit\" onClick={() => setUpdateMode(true)}></i>\n                                <i className=\"singlePostIcon far fa-trash-alt\" onClick={handleDelete}></i>\n                            </div>\n                        )}\n                    </h1>\n                )\n            }\n                <div className=\"singlePostInfo\">\n                    <span className=\"singlePostAuthor\">Author: \n                    <Link to={`/?user=${post.username}`} className=\"link\"> \n                        <b>{post.username}</b>\n                    </Link>\n                        </span>\n                    <span className=\"singlePostDate\">{new Date(post.createdAt).toDateString()}</span>\n                </div>\n                {updateMode ? (\n                    <textarea className=\"singlePostDescInput\" value={desc} onChange={(e) => setDesc(e.target.value)}/>\n                    ) : (\n                        <p className=\"singlePostDesc\"> {desc} </p>\n                    )\n                }\n                {updateMode && \n                    <button className=\"singlePostButton\" onClick={handleUpdate}>Update</button>\n                }\n            </div>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}